<html ng-app="sorter">
    <head>
        <!-- Used by ui router -->
        <base href="/">

        <!-- This will make sure  -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Car Sorting App</title>

        <!-- Dependencies -->
        <link rel="stylesheet" href="/bower_components/angular-material/angular-material.min.css">

        <!-- Customer CSS -->
        <link rel="stylesheet" href="/css/styles.css">

        <!-- Fallback Dependencies -->
        <!--
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">
        -->
    </head>

    <body ng-controller="IndexController as vm">

        <md-toolbar>
            <h1 flex>Car Sorting App</h1>
        </md-toolbar>
        
        <md-tabs class="heightfill">
            <md-tab label="Search Cars With Angular ng-repeat Filter">
                <md-content layout="column" class="md-padding heightfill" ng-cloak>

                    <p>
                        This method uses Angular to do the ordering and searching of all cars. 
                        It starts by displaying all cars (This will render slowly because it is trying to display the whole list at 
                        once there is a faster demo on the 3rd tab).
                    </p>
                    <p>
                        This uses Angular ng-repeat to display all the items. In the ng-repeat I have <code>orderBy: 'Make_Name.trim()'</code>,
                        which will order the list alphabetically by the Make_Name property. The reason I use the trim() method is because 
                        some of the names have white space in front which will make the ordering wrong. i.e. ' Jeep' would come before 'Aston Martin'
                    </p>
                    <p>
                        To do the searching I use the ng-repeat filter method (which is not a true search, that is in the second tab)<code>filter: vm.search</code>
                        which will filter the list down to items only containing the query string that is typed into the top search bar.
                    </p>

                    <md-input-container>
                        <label>Search</label>
                        <input type="text" ng-model="vm.search">
                    </md-input-container>

                    <md-list flex>
                        <md-subheader ng-if="vm.cars.length > 0">
                            Cars ({{vm.cars.length}})
                        </md-subheader>

                        <h2 ng-if="vm.cars.length == 0">
                            Loading Cars...
                        </h2>
                        <!-- I used Angular's build in repeater ordering the list by the Make_Name. I also use the ng-repeat filter function to perform the search
                        With the Cars there was an issue with the way they were being ordered because a lot of them had blank spaces in front of them so in the orderBy I 
                        used the JavaScript trim() method to ensure that they are ordered properly. -->
                        <md-list-item class="md-3-line md-whiteframe-5dp" ng-repeat="car in vm.cars | orderBy:'Make_Name.trim()' | filter: vm.search">
                            <div class="md-list-item-text">
                                <h3>{{car.Make_Name}}</h3>
                                <p>Make ID: {{car.Make_ID}}</p>
                            </div>
                        </md-list-item>
                    </md-list>
                </md-content>
            </md-tab>

            <md-tab label="Search By Calling Angular Function">
                <md-content layout="column" class="md-padding heightfill" ng-cloak>

                    <p>This method calls a function in the Angular controller which does a search of all the items in the vm.cars array. I am still using Angular to order the list</p>
                    
                    <p>
                        I created an Array.prototype method called Search which will call Array.prototype.filter on the vm.cars 
                        array (which contains all the available cars) and return all values where <code>Make_Name.toLowerCase().includes(query.toLowerCase())</code>
                        I do the .toLowerCase() method to make sure that searching is case insensitive so that we pull back all relevant results.
                    </p>

                    <md-input-container>
                        <label>Search</label>
                        <input type="text" ng-model="vm.keysearch" ng-keyup="vm.search1(vm.keysearch)">
                    </md-input-container>


                    <md-list flex>
                        <md-subheader ng-if="vm.cars2.length > 0">
                            Cars ({{vm.cars2.length}})
                        </md-subheader>

                        <h2 ng-if="vm.cars2.length == 0">
                            Type in the search box to start filtering through a list of cars
                        </h2>
                        <!-- This example maintains the alphabetical order with the orderBy function even when searching -->
                        <md-list-item class="md-3-line md-whiteframe-5dp" ng-repeat="car in vm.cars2 | orderBy:'Make_Name.trim()' track by $index">
                            <div class="md-list-item-text">
                                <h3>{{car.Make_Name}}</h3>
                                <p>Make ID: {{car.Make_ID}}</p>
                            </div>
                        </md-list-item>
                    </md-list>
                </md-content>
            </md-tab>

            <md-tab label="Search All Items From A BackEnd Function">
                <md-content layout="column" class="md-padding heightfill" ng-cloak>

                    <p>
                        This method displays all items much faster by using an infinite scroll mechanism.
                        Rather than displaying all items at once (like the first method) it only displays a few items at a time
                        until you scroll to the bottom of the page, then more items will be displayed from the list.
                        I am still using Angular to order the list
                    </p>
                    
                    <p>
                        To do the searching on this example I call a backend HTTP POST function that sorts through the list pulled down from the API.
                    </p>

                    <md-input-container>
                        <label>Search</label>
                        <input type="text" ng-model="vm.keysearch2" ng-keyup="vm.search2(vm.keysearch2)">
                    </md-input-container>


                    <md-list flex>
                        <md-subheader ng-if="vm.cars3.length > 0">
                            Cars ({{vm.cars2.length}})
                        </md-subheader>

                        <h2 ng-if="vm.cars3.length == 0">
                            Type in the search box to start filtering through a list of cars
                        </h2>

                        <md-list-item class="md-3-line md-whiteframe-5dp" ng-repeat="car in vm.cars3 | orderBy:'Make_Name.trim()' track by $index">
                                <div class="md-list-item-text">
                                    <h3>{{car.Make_Name}}</h3>
                                    <p>Make ID: {{car.Make_ID}}</p>
                                </div>
                            </md-list-item>

                    </md-list>
                </md-content>
            </md-tab>
        </md-tabs>


        <!-- Dependencies -->
        <script src="/bower_components/angular/angular.min.js"></script>
        <script src="/bower_components/angular-animate/angular-animate.min.js"></script>
        <script src="/bower_components/angular-aria/angular-aria.min.js"></script>
        <script src="/bower_components/angular-messages/angular-messages.min.js"></script>
        <script src="/bower_components/angular-material/angular-material.min.js"></script>
        <script src="/bower_components/angular-ui-router/release/angular-ui-router.min.js"></script>

        <!-- Fallback Dependencies If Bower Components Fails -->
        <!--
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.js"></script>
        <script src="//unpkg.com/angular-ui-router/release/angular-ui-router.min.js"></script>
        -->

        <!-- Custom Scripts -->
        <script src="/js/index.module.js"></script>
        <script src="/js/index.controller.js"></script>
    </body>
</html>